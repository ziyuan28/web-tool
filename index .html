<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的全能工具箱 v3.1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        [v-cloak] { display: none; }
        body { 
            background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%);
            font-family: 'Segoe UI', sans-serif;
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .btn-bounce { transition: transform 0.1s; }
        .btn-bounce:active { transform: scale(0.95); }
        .fade-enter-active, .fade-leave-active { transition: opacity 0.3s ease, transform 0.3s ease; }
        .fade-enter-from { opacity: 0; transform: translateY(10px); }
        .fade-leave-to { opacity: 0; transform: translateY(-10px); }
        .notepad-bg {
            background-image: radial-gradient(#e5e7eb 1px, transparent 1px);
            background-size: 20px 20px;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

<div id="app" v-cloak class="w-full max-w-6xl bg-white/90 backdrop-blur-md rounded-3xl shadow-2xl overflow-hidden flex flex-col md:flex-row h-[90vh]">
    
    <!-- 左侧导航 -->
    <div class="w-full md:w-20 lg:w-64 bg-slate-800 text-white flex flex-col p-4 z-10">
        <div class="mb-8 flex items-center justify-center lg:justify-start lg:px-4 space-x-3">
            <div class="w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center shadow-lg shadow-blue-500/50">
                <i class="fas fa-cube text-xl"></i>
            </div>
            <span class="text-xl font-bold tracking-wider hidden lg:block">ToolBox</span>
        </div>
        <nav class="space-y-2 flex-1 overflow-y-auto no-scrollbar">
            <button v-for="item in navItems" :key="item.id" @click="currentTab = item.id" 
                :class="currentTab === item.id ? 'bg-blue-600 shadow-blue-600/30' : 'text-slate-400 hover:bg-slate-700'"
                class="btn-bounce w-full flex items-center p-3 rounded-xl transition-all duration-300 group relative">
                <div class="w-10 h-10 flex-shrink-0 flex items-center justify-center rounded-lg transition-colors text-lg"
                     :class="currentTab === item.id ? 'text-white' : 'text-slate-400 group-hover:text-white'">
                    <i :class="item.icon"></i>
                </div>
                <span class="font-medium ml-2 hidden lg:block" :class="currentTab === item.id ? 'text-white' : ''">{{ item.name }}</span>
            </button>
        </nav>
    </div>

    <!-- 主内容区 -->
    <div class="flex-1 bg-slate-50 relative overflow-hidden flex flex-col">
        <header class="h-16 bg-white/50 backdrop-blur border-b border-slate-200 flex items-center justify-between px-8">
            <h2 class="text-xl font-bold text-slate-700 flex items-center">
                <i :class="currentNavIcon" class="mr-3 text-blue-500"></i>
                {{ currentNavName }}
            </h2>
            <div class="text-sm text-slate-400">{{ todayDate }}</div>
        </header>

        <div class="flex-1 overflow-y-auto p-6 md:p-10 no-scrollbar relative">
            <transition name="fade" mode="out-in">
                
                <!-- 1. 代办清单 -->
                <div v-if="currentTab === 'todo'" class="max-w-3xl mx-auto space-y-6">
                    <div class="flex gap-3">
                        <input v-model="newTodo" @keyup.enter="addTodo" type="text" placeholder="输入任务按回车..." class="flex-1 bg-white border-none shadow-sm rounded-xl px-5 py-4 outline-none focus:ring-2 ring-blue-400 transition">
                        <button @click="addTodo" class="btn-bounce bg-blue-500 text-white w-14 rounded-xl shadow-lg shadow-blue-500/30 hover:bg-blue-600"><i class="fas fa-plus"></i></button>
                    </div>
                    <ul class="space-y-3">
                        <li v-for="(todo, index) in todos" :key="todo.id" class="bg-white p-4 rounded-xl shadow-sm flex items-center justify-between group hover:shadow-md transition-all border border-slate-100">
                            <div class="flex items-center cursor-pointer" @click="todo.done = !todo.done">
                                <div :class="todo.done ? 'bg-green-500 border-green-500' : 'border-slate-300'" class="w-5 h-5 rounded border-2 flex items-center justify-center mr-3 transition-colors">
                                    <i v-if="todo.done" class="fas fa-check text-white text-[10px]"></i>
                                </div>
                                <span :class="{'line-through text-slate-400': todo.done}" class="text-slate-700">{{ todo.text }}</span>
                            </div>
                            <button @click="removeTodo(index)" class="text-slate-300 hover:text-red-500 transition px-2"><i class="fas fa-trash"></i></button>
                        </li>
                    </ul>
                </div>

                <!-- 2. 番茄钟 (已加入自定义时间) -->
                <div v-else-if="currentTab === 'pomodoro'" class="flex flex-col items-center justify-center h-full">
                    <div class="relative w-72 h-72 flex items-center justify-center">
                        <svg class="w-full h-full transform -rotate-90">
                            <circle cx="144" cy="144" r="130" stroke="#e2e8f0" stroke-width="12" fill="none"></circle>
                            <circle cx="144" cy="144" r="130" stroke="#3b82f6" stroke-width="12" fill="none" stroke-linecap="round" 
                                :stroke-dasharray="2 * Math.PI * 130" 
                                :stroke-dashoffset="2 * Math.PI * 130 * (1 - pomodoro.progress/100)"
                                class="transition-all duration-1000 ease-linear"></circle>
                        </svg>
                        <div class="absolute text-center">
                            <div class="text-6xl font-bold text-slate-700 font-mono">{{ formatTime(pomodoro.timeLeft) }}</div>
                            <div class="text-slate-400 mt-2 text-sm">{{ pomodoro.isRunning ? '专注中...' : '准备开始' }}</div>
                        </div>
                    </div>
                    <div class="mt-8 flex gap-6">
                        <button @click="togglePomodoro" :class="pomodoro.isRunning ? 'bg-amber-500' : 'bg-blue-500'" class="btn-bounce w-16 h-16 rounded-2xl text-white text-xl shadow-xl flex items-center justify-center hover:opacity-90 transition">
                            <i :class="pomodoro.isRunning ? 'fas fa-pause' : 'fas fa-play'"></i>
                        </button>
                        <button @click="resetPomodoro" class="btn-bounce w-16 h-16 rounded-2xl bg-white text-slate-500 text-xl shadow-lg border border-slate-100 flex items-center justify-center hover:bg-slate-50 transition">
                            <i class="fas fa-undo"></i>
                        </button>
                    </div>
                    <!-- 新增时间设置栏 -->
                    <div class="mt-8 flex items-center bg-white p-2 rounded-xl shadow-sm border border-slate-100">
                        <span class="text-xs text-slate-400 font-bold ml-2 mr-2">设置时长:</span>
                        <button @click="setCustomTime(25)" class="px-3 py-1 text-sm bg-slate-100 hover:bg-blue-100 text-slate-600 hover:text-blue-600 rounded-lg mr-2 transition">25分</button>
                        <button @click="setCustomTime(5)" class="px-3 py-1 text-sm bg-slate-100 hover:bg-green-100 text-slate-600 hover:text-green-600 rounded-lg mr-2 transition">5分</button>
                        <div class="flex items-center border-l border-slate-200 pl-2">
                            <input v-model.number="pomodoro.inputMin" type="number" placeholder="自定义" class="w-14 text-center bg-transparent outline-none text-sm text-slate-700 font-bold">
                            <button @click="setCustomTime(pomodoro.inputMin)" class="text-xs bg-slate-800 text-white px-2 py-1 rounded ml-1 hover:bg-slate-700">OK</button>
                        </div>
                    </div>
                </div>

                <!-- 3. 便签 -->
                <div v-else-if="currentTab === 'memo'" class="h-full flex flex-col max-w-4xl mx-auto">
                    <div class="flex-1 relative shadow-sm rounded-xl overflow-hidden border border-yellow-200">
                        <div class="bg-yellow-100 h-8 flex items-center px-4 border-b border-yellow-200">
                            <div class="flex gap-2"><div class="w-3 h-3 rounded-full bg-red-400"></div><div class="w-3 h-3 rounded-full bg-yellow-400"></div><div class="w-3 h-3 rounded-full bg-green-400"></div></div>
                            <div class="ml-auto text-xs text-yellow-600 font-bold">自动保存中...</div>
                        </div>
                        <textarea v-model="memoText" class="w-full h-full p-6 outline-none resize-none text-slate-700 leading-relaxed text-lg notepad-bg bg-yellow-50 font-mono" placeholder="在这里记录..."></textarea>
                    </div>
                </div>

                <!-- 4. 密码生成 -->
                <div v-else-if="currentTab === 'password'" class="max-w-xl mx-auto pt-10">
                    <div class="bg-white p-8 rounded-3xl shadow-xl border border-slate-100">
                        <div class="bg-slate-100 p-4 rounded-xl mb-6 flex justify-between items-center break-all min-h-[4rem]">
                            <span class="text-xl font-mono text-slate-700 font-bold tracking-wide">{{ generatedPassword || '点击下方生成' }}</span>
                            <button @click="copyPassword" class="ml-4 text-blue-500 hover:text-blue-700 p-2"><i class="fas fa-copy text-xl"></i></button>
                        </div>
                        <div class="space-y-6">
                            <div><label class="flex justify-between text-slate-600 font-bold mb-2"><span>密码长度: {{ passConfig.length }}</span></label><input type="range" v-model.number="passConfig.length" min="6" max="32" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-blue-500"></div>
                            <div class="grid grid-cols-2 gap-4">
                                <label class="flex items-center p-3 border border-slate-200 rounded-xl cursor-pointer hover:bg-slate-50"><input type="checkbox" v-model="passConfig.upper" class="w-5 h-5 text-blue-600 rounded"><span class="ml-2 text-slate-600">包含大写</span></label>
                                <label class="flex items-center p-3 border border-slate-200 rounded-xl cursor-pointer hover:bg-slate-50"><input type="checkbox" v-model="passConfig.numbers" class="w-5 h-5 text-blue-600 rounded"><span class="ml-2 text-slate-600">包含数字</span></label>
                                <label class="flex items-center p-3 border border-slate-200 rounded-xl cursor-pointer hover:bg-slate-50"><input type="checkbox" v-model="passConfig.symbols" class="w-5 h-5 text-blue-600 rounded"><span class="ml-2 text-slate-600">包含符号</span></label>
                            </div>
                            <button @click="generatePassword" class="btn-bounce w-full bg-slate-800 text-white py-4 rounded-xl font-bold text-lg hover:bg-slate-900 shadow-lg">生成随机密码</button>
                        </div>
                    </div>
                </div>

                <!-- 5. 倒计时 -->
                <div v-else-if="currentTab === 'countdown'" class="max-w-3xl mx-auto pt-10">
                    <div class="bg-gradient-to-r from-violet-600 to-indigo-600 rounded-2xl p-6 text-white shadow-lg mb-8">
                        <div class="flex gap-3 flex-col sm:flex-row">
                            <input v-model="countdown.title" class="flex-1 bg-white/20 border-none rounded-lg px-4 py-2 placeholder-white/70 text-white outline-none focus:bg-white/30" placeholder="目标名称">
                            <input v-model="countdown.date" type="date" class="bg-white/20 border-none rounded-lg px-4 py-2 text-white outline-none">
                            <button @click="saveCountdown" class="bg-white text-indigo-600 px-6 py-2 rounded-lg font-bold hover:bg-indigo-50 transition">保存</button>
                        </div>
                    </div>
                    <div v-if="countdown.targetDate" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div v-for="(val, unit) in countdown.diff" class="bg-white p-5 rounded-2xl shadow-sm text-center border border-slate-100">
                            <div class="text-4xl font-bold text-indigo-600 mb-1">{{ val }}</div>
                            <div class="text-xs text-slate-400 uppercase">{{ unitLabels[unit] }}</div>
                        </div>
                    </div>
                </div>

                <!-- 6. 记账本 -->
                <div v-else-if="currentTab === 'money'" class="max-w-3xl mx-auto h-full flex flex-col">
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="bg-emerald-500 text-white p-5 rounded-2xl shadow-lg shadow-emerald-500/20"><div class="text-emerald-100 text-xs mb-1">收入</div><div class="text-2xl font-bold">+ {{ totalIncome }}</div></div>
                        <div class="bg-rose-500 text-white p-5 rounded-2xl shadow-lg shadow-rose-500/20"><div class="text-rose-100 text-xs mb-1">支出</div><div class="text-2xl font-bold">- {{ totalExpense }}</div></div>
                    </div>
                    <div class="flex gap-2 mb-4">
                        <select v-model="newRecord.type" class="bg-white border-none p-3 rounded-xl shadow-sm outline-none"><option value="expense">支出</option><option value="income">收入</option></select>
                        <input v-model="newRecord.desc" placeholder="项目" class="flex-1 bg-white border-none p-3 rounded-xl shadow-sm outline-none">
                        <input v-model.number="newRecord.amount" type="number" placeholder="金额" class="w-24 bg-white border-none p-3 rounded-xl shadow-sm outline-none">
                        <button @click="addRecord" class="bg-slate-800 text-white w-12 rounded-xl shadow-sm hover:bg-slate-700"><i class="fas fa-check"></i></button>
                    </div>
                    <div class="flex-1 overflow-y-auto space-y-2 no-scrollbar">
                        <div v-for="(r, i) in records" class="bg-white p-3 rounded-xl flex justify-between items-center border border-slate-50">
                            <div><div class="font-bold text-slate-700">{{ r.desc }}</div><div class="text-xs text-slate-400">{{ r.date }}</div></div>
                            <div :class="r.type==='income'?'text-emerald-500':'text-rose-500'" class="font-bold font-mono">{{ r.type==='income'?'+':'-' }}{{ r.amount }}</div>
                            <i @click="removeRecord(i)" class="fas fa-times text-slate-300 cursor-pointer hover:text-red-500 ml-3"></i>
                        </div>
                    </div>
                </div>

            </transition>
        </div>
    </div>
</div>

<script>
    const { createApp, ref, computed, watch } = Vue;

    createApp({
        setup() {
            const currentTab = ref('todo');
            const navItems = [
                { id: 'todo', name: '代办清单', icon: 'fas fa-check-square' },
                { id: 'pomodoro', name: '番茄专注', icon: 'fas fa-clock' },
                { id: 'memo', name: '随手便签', icon: 'fas fa-sticky-note' },
                { id: 'password', name: '密码生成', icon: 'fas fa-key' },
                { id: 'countdown', name: '倒计时', icon: 'fas fa-hourglass-start' },
                { id: 'money', name: '记账本', icon: 'fas fa-wallet' }
            ];
            
            const currentNavName = computed(() => navItems.find(i => i.id === currentTab.value)?.name);
            const currentNavIcon = computed(() => navItems.find(i => i.id === currentTab.value)?.icon);
            const todayDate = new Date().toLocaleDateString('zh-CN', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

            // Todo
            const newTodo = ref('');
            const todos = ref(JSON.parse(localStorage.getItem('v3_todos') || '[]'));
            const addTodo = () => { if(newTodo.value.trim()){ todos.value.unshift({id: Date.now(), text:newTodo.value, done:false}); newTodo.value=''; }};
            const removeTodo = (i) => todos.value.splice(i,1);
            watch(todos, v => localStorage.setItem('v3_todos', JSON.stringify(v)), {deep:true});

            // Pomodoro (Modified)
            const pomodoro = ref({ timeLeft: 25*60, total: 25*60, isRunning: false, progress: 0, inputMin: '' });
            let timer = null;
            const formatTime = (s) => `${Math.floor(s/60).toString().padStart(2,'0')}:${(s%60).toString().padStart(2,'0')}`;
            const setCustomTime = (mins) => {
                if(!mins || mins <= 0) return;
                clearInterval(timer); 
                pomodoro.value.isRunning = false;
                pomodoro.value.total = mins * 60; 
                pomodoro.value.timeLeft = mins * 60; 
                pomodoro.value.progress = 0; 
                pomodoro.value.inputMin = ''; 
            };
            const togglePomodoro = () => {
                if(pomodoro.value.isRunning) { clearInterval(timer); pomodoro.value.isRunning=false; }
                else {
                    pomodoro.value.isRunning = true;
                    timer = setInterval(() => {
                        if(pomodoro.value.timeLeft > 0) {
                            pomodoro.value.timeLeft--;
                            pomodoro.value.progress = ((pomodoro.value.total - pomodoro.value.timeLeft)/pomodoro.value.total)*100;
                        } else { clearInterval(timer); pomodoro.value.isRunning=false; alert('完成！'); }
                    }, 1000);
                }
            };
            const resetPomodoro = () => { clearInterval(timer); pomodoro.value.isRunning=false; pomodoro.value.timeLeft=pomodoro.value.total; pomodoro.value.progress=0; };

            // Memo
            const memoText = ref(localStorage.getItem('v3_memo') || '');
            watch(memoText, (val) => localStorage.setItem('v3_memo', val));

            // Password
            const passConfig = ref({ length: 12, upper: true, numbers: true, symbols: false });
            const generatedPassword = ref('');
            const generatePassword = () => {
                const lower = 'abcdefghijklmnopqrstuvwxyz'; const upper = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'; const nums = '0123456789'; const syms = '!@#$%^&*()_+~`|}{[]:;?><,./-=';
                let chars = lower; if(passConfig.value.upper) chars += upper; if(passConfig.value.numbers) chars += nums; if(passConfig.value.symbols) chars += syms;
                let pass = ''; for(let i=0; i<passConfig.value.length; i++) pass += chars.charAt(Math.floor(Math.random() * chars.length));
                generatedPassword.value = pass;
            };
            const copyPassword = () => { if(generatedPassword.value) navigator.clipboard.writeText(generatedPassword.value); };

            // Countdown
            const countdown = ref(JSON.parse(localStorage.getItem('v3_cd') || '{}'));
            const unitLabels = { days:'天', hours:'时', minutes:'分', seconds:'秒' };
            const saveCountdown = () => { if(countdown.value.date) { countdown.value.targetDate = countdown.value.date + 'T00:00:00'; localStorage.setItem('v3_cd', JSON.stringify(countdown.value)); }};
            setInterval(() => {
                if(!countdown.value.targetDate) return;
                const diff = new Date(countdown.value.targetDate) - new Date();
                if(diff<0) return;
                countdown.value.diff = {
                    days: Math.floor(diff/(1000*60*60*24)), hours: Math.floor((diff%(1000*60*60*24))/(1000*60*60)),
                    minutes: Math.floor((diff%(1000*60*60))/(1000*60)), seconds: Math.floor((diff%(1000*60))/1000)
                };
            }, 1000);

            // Money
            const newRecord = ref({type:'expense', desc:'', amount:''});
            const records = ref(JSON.parse(localStorage.getItem('v3_money') || '[]'));
            const totalIncome = computed(() => records.value.filter(r=>r.type==='income').reduce((a,b)=>a+b.amount,0));
            const totalExpense = computed(() => records.value.filter(r=>r.type==='expense').reduce((a,b)=>a+b.amount,0));
            const addRecord = () => { if(newRecord.value.amount){ records.value.unshift({...newRecord.value, date: new Date().toLocaleDateString()}); newRecord.value.desc=''; newRecord.value.amount=''; localStorage.setItem('v3_money', JSON.stringify(records.value)); }};
            const removeRecord = (i) => { records.value.splice(i,1); localStorage.setItem('v3_money', JSON.stringify(records.value)); };

            return {
                currentTab, navItems, currentNavName, currentNavIcon, todayDate,
                newTodo, todos, addTodo, removeTodo,
                pomodoro, formatTime, togglePomodoro, resetPomodoro, setCustomTime,
                memoText, passConfig, generatedPassword, generatePassword, copyPassword,
                countdown, unitLabels, saveCountdown,
                newRecord, records, totalIncome, totalExpense, addRecord, removeRecord
            };
        }
    }).mount('#app');
</script>
</body>
</html>